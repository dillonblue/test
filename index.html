<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä»»å‹™ç®¡ç†éŠæˆ²æ¿</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 20px;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      margin-bottom: 8px;
    }
    #stats {
      text-align: center;
      margin-bottom: 16px;
      font-size: 1rem;
    }
    #stats strong {
      font-size: 1.1rem;
    }
    .board {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-start;
      justify-content: center;
      gap: 12px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .column {
      background: #eef0f4;
      border-radius: 10px;
      padding: 10px;
      width: 280px;
      flex: 0 0 auto;
      display: flex;
      flex-direction: column;
      max-height: 80vh;
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.15);
    }
    .column h2 {
      font-size: 1.05rem;
      margin: 0 0 6px;
      text-align: center;
    }
    .card-list {
      flex: 1 1 auto;
      overflow-y: auto;
      margin-bottom: 6px;
      padding-right: 4px;
    }
    .card {
      background: #ffffff;
      border-radius: 6px;
      padding: 6px 8px;
      margin: 5px 0;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 1px 2px rgba(15, 23, 42, 0.08);
      font-size: 0.9rem;
    }
    .card.done {
      opacity: 0.55;
      text-decoration: line-through;
    }
    .card.redeemed {
      opacity: 0.6;
    }
    .card input[type=checkbox] {
      margin: 0;
      flex-shrink: 0;
      transform: scale(1.1);
    }
    .card button.redeem-button {
      flex-shrink: 0;
      border-radius: 999px;
      border: none;
      padding: 4px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      background: #10b981;
      color: #fff;
    }
    .card button.redeem-button[disabled] {
      background: #9ca3af;
      cursor: default;
    }
    .card-text {
      flex: 1 1 auto;
      word-break: break-word;
    }
    .daily-task    { border-left: 4px solid #22c55e; }  /* ç¶ è‰²: æ¯æ—¥ä»»å‹™ */
    .challenge-task{ border-left: 4px solid #f97316; }  /* æ©™è‰²: é™æ™‚æŒ‘æˆ° */
    .couple-task   { border-left: 4px solid #ec4899; }  /* ç²‰è‰²: å¤«å¦»äº’å‹• */
    .reward-card   { border-left: 4px solid #a855f7; }  /* ç´«è‰²: çå‹µå…Œæ› */
    .achievement-card { border-left: 4px solid #3b82f6; } /* è—è‰²: æˆå°±å¾½ç«  */
    .add-task-btn {
      border-radius: 999px;
      border: none;
      background: #e5e7eb;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 0.8rem;
    }
    .add-task-btn:hover {
      background: #d1d5db;
    }
    @media (max-width: 768px) {
      body { padding: 10px; }
      .board {
        flex-direction: column;
        align-items: stretch;
      }
      .column {
        width: 100%;
        max-width: 100%;
        margin: 4px 0;
      }
    }
  </style>
</head>
<body>
  <h1>ğŸ¯ ä»»å‹™ç®¡ç†éŠæˆ²æ¿</h1>
  <div id="stats">
    ç©åˆ†ï¼š<strong id="points">0</strong>
    &nbsp;|&nbsp;
    å·²å…Œæ›çå‹µæ•¸ï¼š<strong id="rewards-count">0</strong>
    &nbsp;|&nbsp;
    å®Œæˆä»»å‹™æ•¸ï¼š<strong id="tasks-count">0</strong>
  </div>

  <div class="board">
    <div class="column" id="daily">
      <h2>ğŸŒ æ¯æ—¥ä»»å‹™</h2>
      <div class="card-list"></div>
      <button class="add-task-btn">ï¼‹ æ–°ä»»å‹™</button>
    </div>

    <div class="column" id="challenge">
      <h2>â° é™æ™‚æŒ‘æˆ°</h2>
      <div class="card-list"></div>
      <button class="add-task-btn">ï¼‹ æ–°æŒ‘æˆ°</button>
    </div>

    <div class="column" id="couple">
      <h2>ğŸ’‘ å¤«å¦»äº’å‹•</h2>
      <div class="card-list"></div>
      <button class="add-task-btn">ï¼‹ æ–°äº’å‹•ä»»å‹™</button>
    </div>

    <div class="column" id="rewards">
      <h2>ğŸ çå‹µå…Œæ›</h2>
      <div class="card-list"></div>
    </div>

    <div class="column" id="achievements">
      <h2>ğŸ… æˆå°±å¾½ç« </h2>
      <div class="card-list"></div>
    </div>
  </div>

  <script>
    const defaultData = {
      points: 0,
      tasksCompleted: 0,
      challengeCompletedCount: 0,
      tasks: {
        daily: [
          { text: "ğŸ“§ æª¢æŸ¥éƒµä»¶ä¿¡ç®±", completed: false, points: 5 },
          { text: "ğŸ“¦ ä»Šæ—¥å‡ºè²¨è™•ç†", completed: false, points: 10 },
          { text: "ğŸ§¾ å°å¸³ / è¨˜å¸³æ›´æ–°", completed: false, points: 5 }
        ],
        challenge: [
          { text: "ğŸ”¥ 3æ—¥å…§å®Œæˆä¸€å€‹ã€ä¸€ç›´æƒ³åšã€éƒ½é‚„æ²’åšã€çš„ä»»å‹™", completed: false, points: 20 }
        ],
        couple: [
          { text: "ğŸ’¬ ä»Šå¤©ä¸»å‹•è·Ÿå¦ä¸€åŠèªªä¸€ä»¶æ„Ÿè¬çš„äº‹", completed: false, points: 5 },
          { text: "ğŸ¤ æœ¬é€±ä¸€èµ·å®Œæˆä¸€ä»¶å®¶å‹™åˆä½œä»»å‹™", completed: false, points: 10 }
        ]
      },
      rewards: [
        { text: "â˜• å’–å•¡ä¸€æ¯", cost: 20, redeemed: false },
        { text: "ğŸ° ä¸‹åˆèŒ¶ç´„æœƒ", cost: 40, redeemed: false },
        { text: "ğŸ•’ ææ—©ä¸‹ç­ä¸€å°æ™‚", cost: 60, redeemed: false }
      ],
      achievements: [],
      achievementsUnlocked: {}
    };

    let saved = localStorage.getItem("gamifiedTaskBoardData");
    let data = saved ? JSON.parse(saved) : defaultData;

    function saveData() {
      localStorage.setItem("gamifiedTaskBoardData", JSON.stringify(data));
    }

    function updateStats() {
      document.getElementById("points").innerText = data.points;
      document.getElementById("tasks-count").innerText = data.tasksCompleted;
      const redeemedCount = data.rewards.filter(r => r.redeemed).length;
      document.getElementById("rewards-count").innerText = redeemedCount;
    }

    function renderTasks() {
      for (let type in data.tasks) {
        const listElem = document.querySelector("#" + type + " .card-list");
        listElem.innerHTML = "";
        data.tasks[type].forEach((task, index) => {
          const card = document.createElement("div");
          card.className = "card " + type + "-task";
          if (task.completed) {
            card.classList.add("done");
          }
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = task.completed;
          if (task.completed) checkbox.disabled = true;
          checkbox.addEventListener("change", () => {
            if (checkbox.checked && !task.completed) {
              task.completed = true;
              card.classList.add("done");
              checkbox.disabled = true;
              data.points += task.points;
              data.tasksCompleted += 1;
              if (type === "challenge") {
                data.challengeCompletedCount += 1;
              }
              updateStats();
              checkAchievements();
              saveData();
            }
          });
          const span = document.createElement("span");
          span.className = "card-text";
          span.textContent = task.text + "  (+" + task.points + " åˆ†)";
          card.appendChild(checkbox);
          card.appendChild(span);
          listElem.appendChild(card);
        });
      }
    }

    function renderRewards() {
      const listElem = document.querySelector("#rewards .card-list");
      listElem.innerHTML = "";
      data.rewards.forEach((reward, index) => {
        const card = document.createElement("div");
        card.className = "card reward-card";
        if (reward.redeemed) card.classList.add("redeemed");
        const btn = document.createElement("button");
        btn.className = "redeem-button";
        btn.textContent = reward.redeemed ? "å·²å…Œæ›" : "å…Œæ›";
        if (reward.redeemed) btn.disabled = true;
        btn.addEventListener("click", () => {
          if (reward.redeemed) return;
          if (data.points >= reward.cost) {
            data.points -= reward.cost;
            reward.redeemed = true;
            btn.textContent = "å·²å…Œæ›";
            btn.disabled = true;
            card.classList.add("redeemed");
            updateStats();
            checkAchievements();
            saveData();
          } else {
            alert("ç©åˆ†ä¸å¤ ï¼Œç„¡æ³•å…Œæ›é€™å€‹çå‹µï¼");
          }
        });
        const span = document.createElement("span");
        span.className = "card-text";
        span.textContent = reward.text + "ï¼ˆ" + reward.cost + " åˆ†ï¼‰";
        card.appendChild(btn);
        card.appendChild(span);
        listElem.appendChild(card);
      });
    }

    function renderAchievements() {
      const listElem = document.querySelector("#achievements .card-list");
      listElem.innerHTML = "";
      data.achievements.forEach(ach => {
        const card = document.createElement("div");
        card.className = "card achievement-card";
        const span = document.createElement("span");
        span.className = "card-text";
        span.textContent = "ğŸ… " + ach.text;
        card.appendChild(span);
        listElem.appendChild(card);
      });
    }

    const achievementConditions = [
      { id: "5tasks", text: "ç´¯ç©å®Œæˆ 5 é …ä»»å‹™ï¼", check: () => data.tasksCompleted >= 5 },
      { id: "10tasks", text: "ç´¯ç©å®Œæˆ 10 é …ä»»å‹™ï¼", check: () => data.tasksCompleted >= 10 },
      { id: "3challenges", text: "å®Œæˆ 3 å€‹é™æ™‚æŒ‘æˆ°ï¼", check: () => data.challengeCompletedCount >= 3 }
    ];

    function checkAchievements() {
      let unlockedAnything = false;
      achievementConditions.forEach(ach => {
        if (!data.achievementsUnlocked[ach.id] && ach.check()) {
          data.achievementsUnlocked[ach.id] = true;
          data.achievements.push({ id: ach.id, text: ach.text });
          alert("æˆå°±è§£é–ï¼š" + ach.text);
          unlockedAnything = true;
        }
      });
      if (unlockedAnything) {
        renderAchievements();
        saveData();
      }
    }

    document.querySelectorAll(".add-task-btn").forEach(button => {
      button.addEventListener("click", () => {
        const colElem = button.parentElement;
        const type = colElem.id;
        const title = prompt("è«‹è¼¸å…¥æ–°ä»»å‹™åç¨±ï¼š");
        if (!title) return;
        const ptsStr = prompt("è«‹è¨­å®šæ­¤ä»»å‹™çš„ç©åˆ†ï¼š", "5");
        const pts = Number(ptsStr) || 0;
        data.tasks[type].push({ text: title, completed: false, points: pts });
        renderTasks();
        saveData();
      });
    });

    updateStats();
    renderTasks();
    renderRewards();
    renderAchievements();
    checkAchievements();
    <!-- Confetti ç‰¹æ•ˆï¼ˆå®Œæ•´å…§åµŒç‰ˆï¼Œä¸éœ€å¤–éƒ¨ç¶²è·¯ï¼‰ -->
<script>
/*
  Ultraâ€“lightweight confetti system
*/
function confetti() {
  const colors = ["#FFC700", "#FF0000", "#2E3191", "#41BBC7"];
  const end = Date.now() + 600;
  
  (function frame() {
    const particle = document.createElement("div");
    particle.style.position = "fixed";
    particle.style.top = "0px";
    particle.style.left = Math.random() * window.innerWidth + "px";
    particle.style.width = "8px";
    particle.style.height = "8px";
    particle.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
    particle.style.opacity = "0.8";
    particle.style.borderRadius = "50%";
    particle.style.pointerEvents = "none";
    particle.style.zIndex = "9999";
    particle.style.transition = "transform 1s, opacity 1s";

    document.body.appendChild(particle);

    requestAnimationFrame(() => {
      particle.style.transform = `translateY(${window.innerHeight}px) rotate(${Math.random()*360}deg)`;
      particle.style.opacity = "0";
    });

    setTimeout(() => particle.remove(), 1000);

    if (Date.now() < end) requestAnimationFrame(frame);
  })();
}
</script>

  </script>
</body>
</html>
